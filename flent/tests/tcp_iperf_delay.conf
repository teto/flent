# -*- mode: python; coding: utf-8 -*-

DESCRIPTION="iperf completion delay 6MB"
DEFAULTS={'PLOT': "all_scaled",
          'HOSTS': []}

IPERF_V6=""
if IP_VERSION == 6:
    IPERF_V6="-V"

# TODO should we add 
DATA_SETS = o([
    ('TCP iperf',
        # -n
         {'command': "iperf -c %s -i %.2f -y C -n 6M %s" % (HOST, max(0.5,STEP_SIZE), IPERF_V6),
             # do we need this ?
          'delay': DELAY,
          'units': 's',
          'runner': 'iperf_csv',})
    ])


PLOTS['iperf_delay']    = {'description': 'Iperf completion time',
                             'type': 'timeseries',
                             'series': [
                                 {'data': 'TCP iperf',
                                      'label': 'completion delay (ms)'}]
							}
     # {'apply_to': [glob("UDP upload*", exclude=["UDP upload avg", "UDP upload sum"])],


      # series glob
      # 'series': [{'data': glob("UDP upload*", exclude=["UDP upload fairness", "UDP upload sum", "UDP upload avg"]),
      #             'label': 'Upload',
      #             'combine_mode': 'meta:MEAN_VALUE'},

# PLOTS = o([
#     ('upload',
#      {'description': 'Upload bandwidth plot',
#       'type': 'timeseries',
#       'legend_title': 'TCP upload',
#       'series': [{'data': 'TCP upload BE0 %s' % HOSTS[0],
#                   'label': 'BE %s' % HOSTS[0],
#                   'linewidth': 2.0},
#                  {'data': 'TCP upload BE1 %s' % HOSTS[1],
#                   'label': 'BE %s' % HOSTS[1]},
#                  {'data': 'TCP upload BE2 %s' % HOSTS[2],
#                   'label': 'BE %s' % HOSTS[2]},
#                  {'data': 'TCP upload BE3 %s' % HOSTS[3],
#                   'label': 'BE %s' % HOSTS[3]},
#                  {'data': 'TCP upload BE4 %s' % HOSTS[4],
#                   'label': 'BE %s' % HOSTS[4]},
#                  {'data': 'TCP upload avg',
#                   'label': 'Avg',
#                   'smoothing': 10,
#                   'color': 'black',
#                   'linewidth': 2}]}),

#     ('upload_scaled',
#      {'description': 'Upload bandwidth w/axes scaled to remove outliers',
#       'parent': 'upload',
#       'scaling': (5,95)})
#      ])

# # include("common.inc")
